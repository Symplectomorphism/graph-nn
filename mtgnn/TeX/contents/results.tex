\section{Results and Discussion}
\label{sec:results}
%
This section presents the results of the experiments conducted to evaluate the
performance of the MTGNN in forecasting the stock indices of MINT and G7
countries. The performance of the MTGNN is compared with the performances of the
AR, VAR-MLP, RNN-GRU, and TCN models. The results are presented in terms of the
RSE, RMSE, MAE, and MAPE evaluation metrics. The best results are bolded, and
the second-best results are underlined in Table~\ref{tab:comparison}.
%
The hyperparameters of MTGNN used to obtain the results are summarized
in Table~\ref{tab:hyperparams}. 

\begin{table}[bt]
    \caption{The hyperparameters of the MTGNN used to train and infer the forecasts.}
    \label{tab:hyperparams}
    \centering
    \begin{tabular}{ *3l }           \toprule
    \emph{Hyperparameter}  & \emph{Value} \\ \cmidrule(lr){1-2}
    Convolution depth & $2$ \\
    Loss & $\ell_1$ \\
    Dropout & $0.3$ \\
    Convolutional channels & $16$ \\
    Residual channels & $16$ \\
    Skip channels & $32$ \\
    Batch size & $8$ \\ 
    Epochs & $30$ \\
    \bottomrule
    \hline
    \end{tabular}
\end{table}
%

After training on the first $60\%$ of the data as shown in
Figure~\ref{fig:alldata}, MTGNN produces the underlying graph structure that
minimizes the $\ell_1$ loss as in Figure~\ref{fig:graph}. Recall that, each node
of this graph represents the stock index of a country, and each edge represents
a link between a pair of stock indices. As shown in Table~\ref{tab:hyperparams},
the depth of the graph convolutions is selected to be $2$. This means
that each node had their feature vector updated by considering the current
information residing in its $2$-hop neighborhood \textit{(i.e., its neighbors
and the neighbors of its neighbors)}. The constructed graph in
Figure~\ref{fig:graph} may be interpreted up to 2-hop neighbors have a direct
effect on the outcome of each node, while the remaining nodes (variables) only
have an indirect effect in predicting the future values of a particular node.
Notice that this graph is constructed by performing and end-to-end stochastic
gradient descent (more precisely, the Adam optimizer), on the losses accrued
between the predicted and the actual values. This means that by no means do we
claim that the constructed graph in Figure~\ref{fig:graph}, is a causal one. It
is the graph that the optimization has constructed such that the resulting loss
is minimized. 

The adjacency matrix, corresponding to the graph in Figure~\ref{fig:graph} is
given by \textbf{A} in equation~\eqref{eq:adjacency}. One may observe the 
strength of the connections (edges) between pairs of stock indices by examining
this matrix. Performing sums over the columns of the adjacency
matrix~\eqref{eq:adjacency} reveals that if only $1$-hop neighborhoods are
considered, the US, Germany, and Canada are the most influential stock indices
among G7 countries with $7$, $5$, and $5$ out-degree connections, respectively.
Among MINT countries, Indonesia and T\"{u}rkiye are the most influential stock
indices with $7$ and $6$ out-degree connections, respectively. Similarly, the
out-degrees of the $2$-hop neighborhoods may be computed by considering the
column sums of the matrix $\bm{A} + \bm{A}^2$. In this case, the US and Canada
are the most influential stock indices among G7 countries with $39$
and $34$ out-degree connections, respectively. Among MINT countries, Indonesia
and T\"{u}rkiye are the most influential stock indices with $31$ and $25$
out-degree connections, respectively. 

\setcounter{MaxMatrixCols}{11}
%
\small
\begin{equation}
\bm{A} = \begin{bmatrix}
0 & 1 & 1 & 0 & 1 & 0 & 0 & 0.98 & 1 & 0 & 0 \\ 
0 & 0 & 1 & 0 & 0 & 1 & 1 & 1 & 0 & 0 & 0 \\
0 & 0 & 0 & 1 & 0.96 & 1 & 1 & 1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 & 1 & 1 & 0 & 1 & 1 & 0 & 0 \\
0 & 1 & 0 & 0 & 0 & 1 & 0 & 1 & 0 & 1 & 0.99 \\
1 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 & 0.9 & 0 & 0 & 0 & 0 & 1 & 1 \\ 
0 & 0 & 0 & 0 & 0 & 1 & 1 & 0 & 1 & 0 & 0 \\
0 & 1 & 1 & 0 & 1 & 1 & 1 & 0 & 0 & 0 & 0 \\
0 & 0.81 & 1 & 1 & 0 & 0 & 0 & 1 & 1 & 0 & 0 \\
0 & 1 & 0 & 0 & 0 & 1 & 0 & 1 & 1 & 0 & 0
\end{bmatrix}
\label{eq:adjacency}
\end{equation}
\normalsize
%
%
\begin{figure}[tbh]
  \centering
  % \includegraphics[width=0.45\textwidth]{./figures/.eps}
  \includegraphics[width=0.48\textwidth]{./figures/graph.eps}
  \caption{The connectivity of the countries' stock indices deduced by the MTGNN.} 
  \label{fig:graph}
\end{figure}


Table~\ref{tab:comparison} provides the comparison of the various performance
metrics~\ref{ssec:metric} over all the algorithms we considered in this work. It
can be observed that MTGNN is excellent across all the stock indices. The table
shows that the second-best results vary across the board. While RNN-GRU achieves
this honor for the indices of two countries (Italy and Germany), TCN is the
second-best model for three countries (T\"{u}rkiye, Japan, and Nigeria) and
VAR-MLP is the second-best model for five countries (France, US, Canada,
Indonesia, and Mexico). 

For completeness, we have provided a plot of the MTGNN's predictions of all the
stock indices for the test dataset in Figure~\ref{fig:predictions}. The
performance of the MTGNN is not only satisfactory in terms of its RSE, RMSE,
MAE, and MAPE performances, but is also visually pleasing, as can be observed by
perusing each plot in the figure. 

\begin{rem}
The MTGNN algorithm normalizes the data by subtracting from each column its individual mean and dividing by its individual standard deviation. All data transformations \textit{(natural logarithm and normalization)} are inverted for the construction of the plots in Figure~\ref{fig:predictions}.
\end{rem}

\setlength{\tabcolsep}{18pt}
\begin{table*}[bt]
    \caption{Comparison of performances of various algorithms from the literature.}
    \label{tab:comparison}
    \centering
    \scalebox{0.89}{
    \begin{tabular}{ *6l }           \toprule
    \textit{Index}& \textit{Algorithm} & \textit{RSE} & \textit{RMSE} & \textit{MAE} & \textit{MAPE} \\  
    \cmidrule(lr){1-6}
    \multirow{5}{*}{\hspace{-5mm}\minitab[l]{FTSE MIB \\ (Italy)}} & AR & $3.503$ & $0.276$ & $0.242$ & $2.4\%$  \\
    & VAR-MLP & $1.066$ & $0.152$ & $0.125$ & $1.2\%$ \\
    & RNN-GRU & $\underline{1.005}$ & $\underline{0.148}$ & $\underline{1.005}$ & $\underline{1.1}\%$\\
    & TCN & $1.545$ & $0.183$ & $0.174$ & $1.7\%$\\
    & MTGNN & $\textbf{0.026}$ & $\textbf{0.024}$ & \textbf{0.020} & $\textbf{0.2}\%$\\
    \midrule
    \multirow{5}{*}{\hspace{-5mm}\minitab[l]{BIST 100 \\ (T\"{u}rkiye)}} & AR & $10.294$ & $1.672$ & $1.600$ & $18.4\%$ \\
    & VAR-MLP & $1.487$ & $0.633$ & $0.558$ & $6.4\%$ \\
    & RNN-GRU & $0.890$ & $0.492$ & $0.428$ & $4.9\%$\\
    & TCN & $\underline{0.439}$ & $\underline{0.346}$ & $\underline{0.331}$ & $\underline{3.8}\%$ \\
    & MTGNN & $\textbf{0.081}$& $\textbf{0.042}$ & $\textbf{0.033}$ & $\textbf{0.4}\%$ \\
    \midrule
    \multirow{5}{*}{\hspace{-5mm}\minitab[l]{CAC 40 \\ (France)}} & AR & $6.939$ & $0.237$ & $0.227$ & $2.6\%$ \\
    & VAR-MLP & $\underline{0.980}$ & $\underline{0.089}$ & $\underline{0.076}$ & $\underline{0.9}\%$ \\
    & RNN-GRU & $5.589$ & $0.213$ & $0.184$ & $2.1\%$\\
    & TCN & $2.246$ & $0.135$ & $0.133$ & $1.5\%$\\
    & MTGNN & $\textbf{0.045}$ & $\textbf{0.020}$ & $\textbf{0.017}$ & $\textbf{0.2}\%$\\
    \midrule
    \multirow{5}{*}{\hspace{-5mm}\minitab[l]{FTSE 100 \\ (UK)}} & AR & $\underline{0.872}$ & $\underline{0.040}$ & $\underline{0.031}$ & $\underline{0.3}\%$\\
    & VAR-MLP & $1.562$ & $0.053$ & $0.046$ & $0.5\%$ \\
    & RNN-GRU & $6.76$ & $0.111$ & $0.093$ & $1.0\%$\\
    & TCN & $10.208$ & $0.136$ & $0.133$ & $1.5\%$\\
    & MTGNN & $\textbf{0.044}$ & $\textbf{0.018}$ & $\textbf{0.016}$ & $\textbf{0.2}\%$\\
    \midrule
    \multirow{5}{*}{\hspace{-5mm}\minitab[l]{DAX PERFORMANCE \\ (Germany)}} & AR & $2.891$ & $0.192$ & $0.175$ & $1.8\%$ \\
    & VAR-MLP & $1.017$ & $0.114$ & $0.092$ & $0.9\%$ \\
    & RNN-GRU & $\underline{0.405}$ & $\underline{0.072}$ & $\underline{0.047}$ & $\underline{0.5}\%$\\ 
    & TCN & $2.706$ & $0.169$ & $0.124$ & $1.9\%$\\
    & MTGNN & $\textbf{0.032}$ & $\textbf{0.023}$ & $\textbf{0.020}$ & $\textbf{0.2}\%$\\
    \midrule
    \multirow{5}{*}{\hspace{-5mm}\minitab[l]{S\&P 500 \\ (US)}} & AR & $10.008$ & $0.357$ & $0.346$ & $4.1\%$ \\
    & VAR-MLP & $\underline{0.965}$ & $\underline{0.111}$ & $\underline{0.092}$ & $\underline{1.1}\%$ \\
    & RNN-GRU & $2.879$ & $0.192$ & $0.157$ & $1.9\%$\\
    & TCN & $2.241$ & $0.169$ & $0.163$ & $1.9\%$ \\
    & MTGNN & $\textbf{0.031}$ & $\textbf{0.021}$ & $\textbf{0.018}$ & $\textbf{0.2}\%$\\
    \midrule
    \multirow{5}{*}{\hspace{-5mm}\minitab[l]{S\&P/TSX \\ (Canada)}}& AR & $16.568$ & $0.209$ & $0.203$ & $2.0\%$ \\
    & VAR-MLP & $\underline{1.104}$ & $\underline{0.054}$ & $\underline{0.043}$ & $\underline{0.4}\%$ \\
    & RNN-GRU & $51.66$ & $0.368$ & $0.337$ & $3.4\%$\\
    & TCN & $5.929$ & $0.125$ & $0.124$ & $1.3\%$\\
    & MTGNN & $\textbf{0.024}$ & $\textbf{0.020}$ & $\textbf{0.017}$ & $\textbf{0.2}\%$\\
    \midrule
    \multirow{5}{*}{\hspace{-5mm}\minitab[l]{IDX COMPOSITE\\ (Indonesia)}} & AR & $2.812$ & $0.050$ & $0.040$ & $0.5\%$ \\
    & VAR-MLP & $\underline{1.111}$ & $\underline{0.031}$ & $\underline{0.027}$ & $\underline{0.3}\%$ \\
    & RNN-GRU & $17.536$ & $0.124$ & $0.117$ & $1.3\%$\\
    & TCN & $66.671$ & $0.241$ & $0.231$ & $2.61\%$ \\
    & MTGNN & $\textbf{0.037}$ & $\textbf{0.016}$ & $\textbf{0.014}$ & $\textbf{0.2}\%$\\
    \midrule
    \multirow{5}{*}{\hspace{-5mm}\minitab[l]{IPC MEXICO\\ (Mexico)}} & AR & $6.134$ & $0.152$ & $0.140$ & $1.3\%$ \\
    & VAR-MLP & $\underline{0.987}$ & $\underline{0.061}$ & $\underline{0.048}$ & $\underline{0.4}\%$ \\
    & RNN-GRU & $1.526$ & $0.076$ & $0.068$ & $0.6\%$\\
    & TCN & $7.981$ & $0.173$ & $0.163$ & $1.5\%$\\
    & MTGNN & $\textbf{0.021}$ & $\textbf{0.022}$ & $\textbf{0.018}$ & $\textbf{0.2}\%$\\
    \midrule
    \multirow{5}{*}{\hspace{-5mm}\minitab[l]{NIKKEI 225 \\ (Japan)}} & AR & $5.273$ & $0.329$ & $0.315$ & $3.0\%$ \\
    & VAR-MLP & $1.597$ & $0.181$ & $0.160$ & $1.6\%$ \\
    & RNN-GRU & $1.654$ & $0.184$ & $0.148$ & $1.4\%$\\
    & TCN & $\underline{0.298}$ & $\underline{0.078}$ & $\underline{0.075}$ & $\underline{0.7}\%$\\
    & MTGNN & $\textbf{0.025}$ & $\textbf{0.025}$ & $\textbf{0.020}$ & $\textbf{0.2}\%$\\
    \midrule
    \multirow{5}{*}{\hspace{-5mm}\minitab[l]{NSE 30 \\ (Nigeria)}} & AR & $6.526$ & $0.747$ & $0.700$ & $8.9\%$ \\
    & VAR-MLP & $1.190$ & $0.319$ & $0.292$ & $3.8\%$ \\
    & RNN-GRU & $0.491$ & $0.205$ & $0.128$ & $1.6\%$\\
    & TCN & $\underline{0.045}$ & $\underline{0.062}$ & $\underline{0.057}$ & $\underline{0.7}\%$\\
    & MTGNN & $\textbf{0.013}$ & $\textbf{0.026}$ & $\textbf{0.018}$ & $\textbf{0.2}\%$ \\
    \bottomrule
    \hline
    \end{tabular}
    }
    \begin{tablenotes}
      \small
      \centering
      \item The best results are bolded, and the second best results are underlined.
    \end{tablenotes}
\end{table*}


\begin{figure*}[tbh]
  \centering
  % \includegraphics[width=0.45\textwidth]{./figures/.eps}
  \includegraphics[width=0.97\textwidth]{./figures/predictions.eps}
  \caption{The predictions obtained MTGNN predictor.} 
  \label{fig:predictions}
\end{figure*}